YUI.add("moodle-atto_reciteditor-button",function(e,t){e.namespace("M.atto_reciteditor").Button=e.Base.create("button",e.M.editor_atto.EditorPlugin,[],{initializer:function(){this.addButton({title:"htmleditor",icon:"html",iconComponent:"atto_reciteditor",callback:this.openHtmlEditor,buttonName:"htmleditor"})},openHtmlEditor:function(e){var o,t;e.preventDefault(),o=this,e=M.cfg.wwwroot,e+="/lib/editor/atto/plugins/reciteditor/view.php",((t=window.open(e,"Éditeur RÉCIT","scrollbars=1")).outerWidth<screen.availWidth||t.outerHeight<screen.availHeight)&&(t.moveTo(0,0),t.resizeTo(screen.availWidth,screen.availHeight)),t.attoInterface={},t.attoInterface.getSettings=function(){var e={};return e.contextid=M.cfg.contextid,e.wwwroot=M.cfg.wwwroot,e.theme=M.cfg.theme,e.themerev=M.cfg.themerev,e.sesskey=M.cfg.sesskey,e},t.attoInterface.getThemeCssRules=function(e){var t,i,r=window.document.styleSheets,o={rules:[],url:[]},n=M.recit.reciteditor.settings.stylesheet_to_add,n=n?n.split(","):[];for(t of r)if(t.href&&t.href.includes(`/theme/styles.php/${M.cfg.theme}`)||n.includes(t.title)){if(null==t.href||e)for(i of t.rules)o.rules.push(i);t.href&&o.url.push(t.href)}return o},t.attoInterface.getThemeUrl=function(){return`${M.cfg.wwwroot}/theme/styles.php/${M.cfg.theme}/${M.cfg.themerev}_${M.recit.reciteditor.settings.currentthemesubrev}/all`},t.attoInterface.getFileTransferData=function(){var e,t=o.get("host"),i=t.get("filepickeroptions").image||{},r={repo_id:0};for(e in r.client_id=i.client_id||0,r.env=i.env||"",r.license=i.defaultlicense||"",r.itemid=i.itemid||0,r.author=i.author||"",e="",i.repositories)if("upload"===i.repositories[e].type){r.repo_id=i.repositories[e].id;break}for(e in i.licenses)if("cc"===i.licenses[e].shortname){r.license=i.licenses[e].shortname;break}return r},t.attoInterface.getContent=function(){return o.editor.getHTML()},t.attoInterface.setContent=function(e){o.editor.setHTML(e),t.close()},t.M=M}})},"@VERSION@",{requires:["moodle-editor_atto-plugin"]});